<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <liknk rel="stylesheet" href="finish.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script> <!-- 제이쿼리설치 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- 부트스트랩 -->

</head>
<body>
    <div class="container">
        <input id="search" placeholder="검색어입력">
    </div>
    <div class="container">
        <div class="row product-list">
            <!-- 반복문으로 추가할 박스
             <div class="col-md-3">
                <img src="">
                <h4>상품명 :</h4>
                <p>가격 : </p>
             </div> -->
        </div>
    </div>
    <div class="container basket-wrap" style="background: white;">
        <h4>장바구니 (드래그 가능)</h4>
        <div class="row basket">

        </div>
    </div>
    <div class="container my-3">
        <h4>최종가격</h4>
        <p class="final-price"></p>
        <button class="buy">구매하기</button>
    </div>

    <div class="modal1" style="display: none;">
        <div class="white-bg">
            <h4>성함</h4>
            <input type="text"id="name">
            <h4>연락처</h4>
            <input type="text"id="phone">
            <button class="show-receipt">입력완료</button>
            <div>
                <button class="close">닫기</button>
            </div>
        </div>
    </div>
    
    <div class="modal2" style="display: none;">
        <div class="white-bg">
            <h4>영수증</h4>
            <canvas id="canvas" width="350" height="350"></canvas>
            <div>
                <button class="close">닫기</button>
            </div>
        </div>
    </div>
<script>
    /* 1. 페이지 로드 시 json파일 상품 데이터 불러오기
    2. html 템플릿 만들기
    3. 반복문으로 상품 갯수 만큼 박스(상품 정보 담긴) 생성 */

    /* 페이지 로드 상품 나열 */
    let products =[]; //products 는 배열이다 선언
    let cart = [];

    $.get('store.jason').then((data)=>{ //: AJAX 함수. 원래 URL자리. 로컬 파일 불러오기도 가능
        products =data.products; //뽑아온 데이터를 변수로 보관 let 안쓰고 바로? 안좋은 습관이라고함

    // html 템플릿
    data.products.forEach((a,i) => {
        $('.product-list').append(`
        <div class="col-md-3">
            <div class="item" draggable="true" data-id="${a.id}"> 
                <img src="${a.photo}">
                <h4>${a.title}</h4>
                <h4>${a.brand}</h4>
                <p>가격 : ${a.price}</p>
                <button class="add data-id="${a.id}">담기</button>
            </div>
        </div>`)
    });

            
/* 
draggable=ture : 이 요소는 드래그 가능
data-id : 노션 참고
id : div 박스 이하의 정보 모두 {} 형태로 담겨있음

========================
담기 버튼 기능
========================
1. 담기 버튼 누름 - 해당 상품을 cart변수에 {} 형태로 보관
2. cart에 같은 id 존재 시, 수량 ++
3. 존재 x시 cart 변수에 {} 하나 추가(해당상품데이터)
4. 장바구니 검정 박스에 cart 변수에 있던 내용 넣어서 html 만들기 
/////////////
*/
    $('.add').click(function(e){
        let productId = e.target.dataset.id; //**html요소에 [] 형태 데이터 저장. 노션
    //버튼 클릭시 누른 상품을 {}형태로 보관
        let 몇번째 = cart.findIndex((a)=> {
            return a.id == productId})
        })

      })   
    });
    })
</script>
</body>
</html>